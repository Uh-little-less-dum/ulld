{"version":3,"sources":["../src/run/main.ts"],"sourcesContent":["import fs from \"fs\";\nimport path from \"path\";\nimport { detect } from \"detect-package-manager\";\nimport type { BuildOutputData, PackageManagers } from \"../types.js\";\nimport shell from \"shelljs\";\nimport { getBuildDataOutputPath, getXdgPaths } from \"../utils/getXdgPaths.js\";\n\nconst commands: Record<PackageManagers, string> = {\n    npm: \"npm run ulldStart\",\n    pnpm: \"pnpm ulldStart\",\n    yarn: \"yarn run ulldStart\",\n};\n\nexport const runUlldApplication = async () => {\n    let buildDataPath = getBuildDataOutputPath()\n    if(!fs.existsSync(buildDataPath)){\n        console.error(`Cannot run ulld application. The automatically generated build data file cannot be found. You'll have to run ULLD manually.`)\n        process.exit(1)\n    }\n\n    let b: BuildOutputData = JSON.parse(\n        fs.readFileSync(buildDataPath, {\n            encoding: \"utf-8\",\n        }),\n    );\n\n    if (!b.buildOutputPath) {\n        console.error(\n            `Build data file is improperly formatted. You'll have to run ULLD manually.`,\n        );\n        process.exit(1);\n    }\n\n    let pm = await detect({\n        cwd: b.buildOutputPath,\n    });\n\n    if (pm === \"bun\") {\n        console.error(\"Ulld does not support bun yet. We can't run this app.\");\n        process.exit(1);\n    }\n\n    let cmd = commands[pm];\n\n    shell.exec(cmd, {\n        cwd: b.buildOutputPath,\n        async: true\n    }, (code, stdout, stderr) => {\n        console.log(stdout)\n    });\n\n}\n"],"mappings":";;;;;;;;AAAA;AAAA,OAAO,QAAQ;AAEf,SAAS,cAAc;AAEvB,OAAO,WAAW;AAGlB,IAAM,WAA4C;AAAA,EAC9C,KAAK;AAAA,EACL,MAAM;AAAA,EACN,MAAM;AACV;AAEO,IAAM,qBAAqB,YAAY;AAC1C,MAAI,gBAAgB,uBAAuB;AAC3C,MAAG,CAAC,GAAG,WAAW,aAAa,GAAE;AAC7B,YAAQ,MAAM,6HAA6H;AAC3I,YAAQ,KAAK,CAAC;AAAA,EAClB;AAEA,MAAI,IAAqB,KAAK;AAAA,IAC1B,GAAG,aAAa,eAAe;AAAA,MAC3B,UAAU;AAAA,IACd,CAAC;AAAA,EACL;AAEA,MAAI,CAAC,EAAE,iBAAiB;AACpB,YAAQ;AAAA,MACJ;AAAA,IACJ;AACA,YAAQ,KAAK,CAAC;AAAA,EAClB;AAEA,MAAI,KAAK,MAAM,OAAO;AAAA,IAClB,KAAK,EAAE;AAAA,EACX,CAAC;AAED,MAAI,OAAO,OAAO;AACd,YAAQ,MAAM,uDAAuD;AACrE,YAAQ,KAAK,CAAC;AAAA,EAClB;AAEA,MAAI,MAAM,SAAS,EAAE;AAErB,QAAM,KAAK,KAAK;AAAA,IACZ,KAAK,EAAE;AAAA,IACP,OAAO;AAAA,EACX,GAAG,CAAC,MAAM,QAAQ,WAAW;AACzB,YAAQ,IAAI,MAAM;AAAA,EACtB,CAAC;AAEL;","names":[]}