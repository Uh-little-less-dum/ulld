import { WithFSSearchParams, AppConfigSchemaOutput } from "@ulld/types";
import { BuildStaticDataOutput } from "@ulld/configschema/buildTypes";
import React from "react";
import { SpecificNoteQueryManager } from "@ulld/api/classes/specificNoteQuery/specificNoteQueryManager";
import appConfig from "appConfig";
import buildData from "buildData"
import { notFound } from "next/navigation";
import { IndividualNoteSwitch } from "@ulld/ui/individualNoteSwitch";

export const dynamic = "force-dynamic";

const categoryId: string = "<<CATEGORY_ID>>";

interface PageProps extends WithFSSearchParams {
    params: {
        slug: string;
    };
}

const NotePage = async ({ params, searchParams }: PageProps) => {
    const docTypeData = appConfig.noteTypes.find((n) => n.id === categoryId);
    if (!docTypeData) {
        return notFound();
    }
    const props = await SpecificNoteQueryManager.formatNoteProps(
        docTypeData.id,
        params,
        searchParams,
        appConfig as AppConfigSchemaOutput,
        buildData as BuildStaticDataOutput
    );
    return <IndividualNoteSwitch {...props} />;
};

NotePage.displayName = `NotePage-${categoryId}`;

export default NotePage;
