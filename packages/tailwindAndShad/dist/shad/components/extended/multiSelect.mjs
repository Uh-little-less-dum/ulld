"use client"
import { b } from '../../../chunk-UF7SUQH7.mjs';
import { h, a, d, f } from '../../../chunk-LHHR6NE6.mjs';
import '../../../chunk-TYM3BFAH.mjs';
import '../../../chunk-ORBRSQKI.mjs';
import '../../../chunk-PD25TUY5.mjs';
import { useCommandState, Command } from 'cmdk';
import { X } from 'lucide-react';
import * as t from 'react';
import { forwardRef, useEffect } from 'react';
import { cn } from '@ulld/utilities/cn';

function ce(r,i){let[a,u]=t.useState(r);return useEffect(()=>{let l=setTimeout(()=>u(r),i||500);return ()=>{clearTimeout(l);}},[r,i]),a}function L(r,i){if(r.length===0)return {};if(!i)return {"":r};let a={};return r.forEach(u=>{let l=u[i]||"";a[l]||(a[l]=[]),a[l].push(u);}),a}function fe(r,i){let a=JSON.parse(JSON.stringify(r));for(let[u,l]of Object.entries(a))a[u]=l.filter(I=>!i.find(d=>d.value===I.value));return a}function me(r,i){for(let[,a]of Object.entries(r))if(a.some(u=>i.find(l=>l.value===u.value)))return !0;return !1}var Y=forwardRef(({className:r,...i},a)=>useCommandState(l=>l.filtered.count===0)?t.createElement("div",{ref:a,className:cn("py-6 text-center text-sm",r),"cmdk-empty":"",role:"presentation",...i}):null);Y.displayName="CommandEmpty";var $=t.forwardRef(({value:r,onChange:i,placeholder:a$1,defaultOptions:u=[],options:l,delay:I,onSearch:d$1,onSearchSync:H,loadingIndicator:q,emptyIndicator:M,maxSelected:F=Number.MAX_SAFE_INTEGER,onMaxSelected:K,hidePlaceholderWhenSelected:P,disabled:O,groupBy:v,className:B,badgeClassName:Q,selectFirstItem:Z=!0,creatable:w=!1,triggerSearchOnFocus:C=!1,commandProps:c,inputProps:N,hideClearAllButton:ee=!1},te)=>{let f$1=t.useRef(null),[b$1,T]=t.useState(!1),[ne,j]=t.useState(!1),[J,A]=t.useState(!1),D=t.useRef(null),[n,E]=t.useState(r||[]),[h$1,G]=t.useState(L(u,v)),[m,V]=t.useState(""),p=ce(m,I||500);t.useImperativeHandle(te,()=>({selectedValue:[...n],input:f$1.current,focus:()=>f$1.current?.focus()}),[n]);let R=e=>{D.current&&!D.current.contains(e.target)&&f$1.current&&!f$1.current.contains(e.target)&&T(!1);},S=t.useCallback(e=>{let o=n.filter(s=>s.value!==e.value);E(o),i?.(o);},[i,n]),oe=t.useCallback(e=>{let o=f$1.current;o&&((e.key==="Delete"||e.key==="Backspace")&&o.value===""&&n.length>0&&(n[n.length-1].fixed||S(n[n.length-1])),e.key==="Escape"&&o.blur());},[S,n]);useEffect(()=>(b$1?(document.addEventListener("mousedown",R),document.addEventListener("touchend",R)):(document.removeEventListener("mousedown",R),document.removeEventListener("touchend",R)),()=>{document.removeEventListener("mousedown",R),document.removeEventListener("touchend",R);}),[b$1]),useEffect(()=>{r&&E(r);},[r]),useEffect(()=>{if(!l||d$1)return;let e=L(l||[],v);JSON.stringify(e)!==JSON.stringify(h$1)&&G(e);},[u,l,v,d$1,h$1]),useEffect(()=>{let e=()=>{let s=H?.(p);G(L(s||[],v));};(async()=>{!H||!b$1||(C&&e(),p&&e());})();},[p,v,b$1,C]),useEffect(()=>{let e=async()=>{A(!0);let s=await d$1?.(p);G(L(s||[],v)),A(!1);};(async()=>{!d$1||!b$1||(C&&await e(),p&&await e());})();},[p,v,b$1,C]);let re=()=>{if(!w||me(h$1,[{value:m,label:m}])||n.find(o=>o.value===m))return;let e=t.createElement(h,{value:m,className:"cursor-pointer",onMouseDown:o=>{o.preventDefault(),o.stopPropagation();},onSelect:o=>{if(n.length>=F){K?.(n.length);return}V("");let s=[...n,{value:o,label:o}];E(s),i?.(s);}},`Create "${m}"`);if(!d$1&&m.length>0||d$1&&p.length>0&&!J)return e},ie=t.useCallback(()=>{if(M)return d$1&&!w&&Object.keys(h$1).length===0?t.createElement(h,{value:"-",disabled:!0},M):t.createElement(Y,null,M)},[w,M,d$1,h$1]),ae=t.useMemo(()=>fe(h$1,n),[h$1,n]),se=t.useCallback(()=>{if(c?.filter)return c.filter;if(w)return (e,o)=>e.toLowerCase().includes(o.toLowerCase())?1:-1},[w,c?.filter]);return t.createElement(a,{ref:D,...c,onKeyDown:e=>{oe(e),c?.onKeyDown?.(e);},className:cn("h-auto overflow-visible bg-transparent",c?.className),shouldFilter:c?.shouldFilter!==void 0?c.shouldFilter:!d$1,filter:se()},t.createElement("div",{className:cn("min-h-10 rounded-md border border-input text-sm ring-offset-background focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2",{"px-3 py-2":n.length!==0,"cursor-text":!O&&n.length!==0},B),onClick:()=>{O||f$1.current?.focus();}},t.createElement("div",{className:"relative flex flex-wrap gap-1"},n.map(e=>t.createElement(b,{key:e.value,className:cn("data-[disabled]:bg-muted-foreground data-[disabled]:text-muted data-[disabled]:hover:bg-muted-foreground","data-[fixed]:bg-muted-foreground data-[fixed]:text-muted data-[fixed]:hover:bg-muted-foreground",Q),"data-fixed":e.fixed,"data-disabled":O||void 0},e.label,t.createElement("button",{className:cn("ml-1 rounded-full outline-none ring-offset-background focus:ring-2 focus:ring-ring focus:ring-offset-2",(O||e.fixed)&&"hidden"),onKeyDown:o=>{o.key==="Enter"&&S(e);},onMouseDown:o=>{o.preventDefault(),o.stopPropagation();},onClick:()=>S(e)},t.createElement(X,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})))),t.createElement(Command.Input,{...N,ref:f$1,value:m,disabled:O,onValueChange:e=>{V(e),N?.onValueChange?.(e);},onBlur:e=>{ne||T(!1),N?.onBlur?.(e);},onFocus:e=>{T(!0),C&&d$1?.(p),N?.onFocus?.(e);},placeholder:P&&n.length!==0?"":a$1,className:cn("flex-1 bg-transparent outline-none placeholder:text-muted-foreground",{"w-full":P,"px-3 py-2":n.length===0,"ml-1":n.length!==0},N?.className)}),t.createElement("button",{type:"button",onClick:()=>{E(n.filter(e=>e.fixed)),i?.(n.filter(e=>e.fixed));},className:cn("absolute right-0 h-6 w-6 p-0",(ee||O||n.length<1||n.filter(e=>e.fixed).length===n.length)&&"hidden")},t.createElement(X,null)))),t.createElement("div",{className:"relative"},b$1&&t.createElement(d,{className:"absolute top-1 z-10 w-full rounded-md border bg-popover text-popover-foreground shadow-md outline-none animate-in",onMouseLeave:()=>{j(!1);},onMouseEnter:()=>{j(!0);},onMouseUp:()=>{f$1.current?.focus();}},J?t.createElement(t.Fragment,null,q):t.createElement(t.Fragment,null,ie(),re(),!Z&&t.createElement(h,{value:"-",className:"hidden"}),Object.entries(ae).map(([e,o])=>t.createElement(f,{key:e,heading:e,className:"h-full overflow-auto"},t.createElement(t.Fragment,null,o.map(s=>t.createElement(h,{key:s.value,value:s.value,disabled:s.disable,onMouseDown:y=>{y.preventDefault(),y.stopPropagation();},onSelect:()=>{if(n.length>=F){K?.(n.length);return}V("");let y=[...n,s];E(y),i?.(y);},className:cn("cursor-pointer",s.disable&&"cursor-default text-muted-foreground")},s.label)))))))))});$.displayName="MultipleSelector";var Re=$;

export { Re as default, ce as useDebounce };
//# sourceMappingURL=out.js.map
//# sourceMappingURL=multiSelect.mjs.map