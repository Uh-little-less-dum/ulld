{"version":3,"sources":["../../src/utils/fsRootGlob.ts","../../src/utils/arrayUtilities.ts","../../src/utils/glob/getGlobServerSide.ts","../../src/schemas/filePath/filePathInput.ts","../../src/utils/fsUtils.ts"],"names":[],"mappings":"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","sourcesContent":["import { SupportedFileType, supportedFileTypes } from \"@ulld/types/enums\"\nimport { filePathGlobPropsSchema } from \"../schemas/filePath/filePathInput.js\"\nimport { z } from 'zod'\nimport { ArrayUtilities } from \"./arrayUtilities.js\"\nimport { AppConfigSchemaOutput } from \"@ulld/types\"\nimport \"server-only\"\nimport { getGlobServerSide } from \"./glob/getGlobServerSide.js\"\n\ninterface FsRootGlobProps {\n    path: string\n    isSinglePath?: boolean\n    fileTypes?: SupportedFileType | SupportedFileType[]\n}\n\n\ntype GlobInput = z.input<typeof filePathGlobPropsSchema>\n\nexport class FsRootGlob {\n    constructor(public props: FsRootGlobProps){}\n\n    formatFileTypeArrayGlobPattern(fts: (SupportedFileType)[] | typeof supportedFileTypes) {\n        return `{${fts.join(\",\")}}`\n    }\n\n    getGlobPattern(defaultOpts?: Partial<GlobInput>): string {\n        let fts = this.props.fileTypes ? ArrayUtilities.beArray(this.props.fileTypes) : supportedFileTypes\n        return `${this.props.path}.${this.formatFileTypeArrayGlobPattern(fts)}`\n    }\n\n    getFetchOpts(defaultOpts?: Partial<GlobInput>): GlobInput {\n        return {\n            type: \"files\",\n            glob: this.getGlobPattern(),\n            ...defaultOpts\n        }\n    }\n\n    // TODO: Add method here to sort these results by the file types preffered order in the appConfig.\n    sortResults(vals: string[]) {\n        return vals\n    }\n\n    async getFileMatches(appConfig: AppConfigSchemaOutput, opts?: Partial<GlobInput>){\n        let res = await getGlobServerSide(this.getFetchOpts(opts), appConfig)\n        return res ? this.sortResults(res) : []\n    }\n}\n","import { Tag, Topic, Subject } from \"@ulld/database/internalDatabaseTypes\";\nimport { Row } from \"@tanstack/react-table\";\n\n// TEST:  Test this properly asap.\nexport class ArrayUtilities {\n    constructor() { }\n    static itemFromListWithLoop<T extends unknown>(list: T[], index: number): T {\n        if (index < list.length - 1) {\n            return list[index];\n        }\n        return list[index % list.length];\n    }\n\n    static listFromListWithLoop<T extends unknown>(list: T[], take: number): T[] {\n        let items: T[] = [];\n        for (var i = 0; i < take; i++) {\n            items.push(ArrayUtilities.itemFromListWithLoop<T>(list, i));\n        }\n        return items;\n    }\n    // TODO: Look up how to type n-dimensional arrays and apply that everywhere this is called\n    static meshGrid<T>(N: number[], dimensions: number) {\n        let d = N;\n        let l = 0;\n        let b: number[][] | number[] = [];\n        for (var i = 0; i < dimensions - 1; i++) {\n            let a = d.flat(dimensions).map(() => N);\n            do {\n                let j = a.slice(l, l + N.length);\n                if (j.length > 0) {\n                    // @ts-ignore\n                    b.length > 0 ? b.push(j) : (b = j);\n                }\n                l += N.length;\n            } while (l < a.length - N.length);\n        }\n        return b as T;\n    }\n\n    static randomFromList<T extends unknown>(list: T[]) {\n        list[Math.floor(Math.random() * list.length)];\n    }\n\n    static compute1DIfNotNull(f: (n: number) => number, axisData: number[]) {\n        let values: number[][] = [[], []];\n        axisData.forEach((n) => {\n            let val = f(n);\n            if (n) {\n                values[0].push(n);\n                values[1].push(val);\n            }\n        });\n        return values;\n    }\n\n    static generateData(func: (n: number) => number) {\n        let data: [number, number][] = [];\n        for (let i = -200; i <= 200; i += 0.1) {\n            data.push([i, func(i)]);\n        }\n        return data;\n    }\n\n    static doesOverlap<T extends unknown>(\n        a: Array<T>,\n        b: Array<T>,\n        caseInsensitive: boolean = false,\n    ): boolean {\n        if (caseInsensitive) {\n            /// @ts-ignore\n            a = a.map((s) => s.toLowerCase());\n        }\n        for (var i = 0; i < b.length; i++) {\n            /// @ts-ignore\n            if (a.indexOf(caseInsensitive ? b[i].toLowerCase() : b[i]) >= 0)\n                return true;\n        }\n        return false;\n    }\n\n    static containsAll<T extends unknown>(a: Array<T>, b: Array<T>): boolean {\n        `Returns true if a contains all elements of b`;\n        for (var i = 0; i < b.length; i++) {\n            if (a.indexOf(b[i]) === -1) return false;\n        }\n        return true;\n    }\n\n    static arrayTruthy(a: any) {\n        Boolean(Array.isArray(a) && a.length > 0);\n    }\n\n    static arrayOrItem<T>(\n        a?: T | T[] | null,\n        validate:\n            | \"nullIfMoreThanOne\"\n            | \"firstIfMoreThanOne\"\n            | \"arrayIfMoreThanOne\"\n            | \"arrayIfExists\"\n            | \"alwaysReturnArray\" = \"arrayIfMoreThanOne\",\n    ): T | null | T[] {\n        if (!a) return validate === \"alwaysReturnArray\" ? [] : null;\n        if (validate === \"alwaysReturnArray\") return Array.isArray(a) ? a : [a];\n        if (Array.isArray(a)) {\n            if (validate === \"arrayIfMoreThanOne\") return a as T[];\n            if (validate === \"firstIfMoreThanOne\") return a[0] as T;\n            if (validate === \"nullIfMoreThanOne\") return a.length === 1 ? a[0] : null;\n            if (validate === \"arrayIfExists\") return a;\n        }\n        return validate === \"arrayIfExists\" ? ([a] as T[]) : (a as T);\n    }\n\n    static asArray = (a: any | any[] | undefined | null) =>\n        Boolean(a) ? (Array.isArray(a) ? a : [a]) : [];\n\n    static arrayStrictBoolean(a: any) {\n        return Array.isArray(a) && a.length > 0;\n    }\n\n    static arange(start: number = 0, end: number = 10, diff: number = 1) {\n        let data = [start];\n        do {\n            data.push(data[data.length - 1] + diff);\n        } while (data[data.length - 1] + diff <= end);\n        return data;\n    }\n\n    static stringArrayToTagSubjectOrTopicConnectOrCreate<\n        T extends Tag | Topic | Subject,\n    >(\n        items: string[],\n    ) {\n        return items.map((t) => ({\n            where: {\n                value: t as string,\n            },\n            create: {\n                value: t as string,\n            },\n        }));\n    }\n\n    static fieldArrayIsSame<\n        T extends { [k: string]: unknown },\n        K extends keyof T,\n    >(a: Row<T>[], k: K): T[K] | undefined {\n        if (!a.length) return;\n        let first = a[0].getValue(k as string) as T[K];\n        return a.every((l) => l.getValue(k as string) === first)\n            ? first\n            : undefined;\n    }\n\n    static toggleItemInArray<T extends unknown>(\n        items: T[],\n        val: T,\n        tester?: (v1: T, v2: T) => boolean,\n        mapAdjustment?: (item: T) => string | number,\n    ) {\n        let _items = mapAdjustment ? items.map(mapAdjustment) : items;\n        return _items.includes(mapAdjustment ? mapAdjustment(val) : (val as any))\n            ? items.filter((a) => {\n                if (mapAdjustment) {\n                    return mapAdjustment(a) !== mapAdjustment(val);\n                } else {\n                    return a !== val;\n                }\n            })\n            : [...items, val];\n    }\n\n    static replaceSelfInArray<T extends unknown, H extends string | number>(\n        arr: T[],\n        comparison: H,\n        equalityCheck: (a: T) => H,\n        replacer: (val: T) => T | any,\n    ) {\n        return arr.map((a) => (equalityCheck(a) === comparison ? replacer(a) : a));\n    }\n    static beArray<T extends unknown>(val: T | T[]): T[] {\n        return Array.isArray(val) ? val : [val]\n    }\n    static concatWithoutDuplicates<T extends unknown>(initial: T[], additional: T[], comparer?: (a: T, b: T) => boolean): T[] {\n        let items = initial\n        for (const item of additional) {\n            if(comparer && !items.some((x) => comparer(x, item))){\n                items.push(item)\n            } else {\n                if(!items.includes(item)){\n                    items.push(item)\n                }\n            }\n        }\n        return items\n    }\n\n    static sliceAroundIndex<T>(data: T[], targetIndex: number, maxItems: number) {\n        let items: T[] = [data[targetIndex]]\n        let i = 1\n        let shouldRun = true\n        do {\n           if(items.length <= targetIndex + i) {\n                items.push(data[targetIndex + i])\n            } \n            if((items.length < maxItems) && (targetIndex - i >= 0)){\n                items.push(data[targetIndex - i])\n            }\n            if(items.length < maxItems && (i + 1 + targetIndex < data.length || targetIndex - (i + 1) > 0)){\n                i++\n            } else {\n                shouldRun = false\n            }\n        } while (shouldRun);\n        return items\n    }\n    static clampInArray<T extends unknown>(arr: T[], index: number): T {\n        return index >= arr.length ? arr[index % arr.length] : arr[index]\n    }\n    static concatWithOptionalArray<T extends unknown>(arr: T[] | undefined | null, newArray: T[]): T[] {\n        return (arr || [] as T[]).concat(newArray)\n    }\n}\n","import { AppConfigSchemaOutput } from \"@ulld/types\";\nimport { glob } from \"glob\";\nimport { z } from \"zod\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { filePathGlobPropsSchema } from \"../../schemas/filePath/filePathInput.js\";\nimport { withForwardSlash } from \"../fsUtils.js\";\n\nexport type GlobInput = z.input<typeof filePathGlobPropsSchema>;\n\nexport const getGlobServerSide = async (\n    props: GlobInput,\n    appConfig: AppConfigSchemaOutput,\n) => {\n    let input = filePathGlobPropsSchema.parse(props);\n    let res = (await glob(\n        input.glob,\n        {\n            cwd: appConfig.fsRoot,\n            ignore: input.ignore || undefined,\n            nodir: input.type === \"files\",\n        },\n    )) as string[];\n    let returnAbsolute = input.returnAs === \"absolute\";\n    if (returnAbsolute) {\n        res = res.map((x) => path.join(appConfig.fsRoot, x));\n    } else {\n        res = res.map((x) => withForwardSlash(x));\n    }\n    if (input.type === \"dirs\") {\n        res = res.filter((x) =>\n            fs\n                .statSync(returnAbsolute ? x : path.join(appConfig.fsRoot, x))\n                .isDirectory(),\n        );\n    }\n    return res;\n};\n","import { z } from \"zod\";\n\nexport const filePathGlobPropsSchema = z.object({\n    glob: z.string().default(\"**/*\").transform((x) => x.startsWith(\"/\") ? x.slice(1) : x),\n    type: z\n        .union([z.literal(\"dirs\"), z.literal(\"files\"), z.literal(\"dirsAndFiles\")])\n        .default(\"files\"),\n    ignore: z.union([z.string(), z.string().array()]).nullish(),\n    returnAs: z.union([z.literal(\"absolute\"), z.literal(\"rootRelative\")]).default(\"absolute\"),\n});\n","import { filePathGlobPropsSchema } from \"../schemas/filePath/filePathInput.js\";\nimport { z } from \"zod\";\nimport axios from \"axios\";\n\nexport const withForwardSlash = (p: string) =>\n    p.startsWith(\"/\") ? p : `/${p}`;\n\nexport const withForwardSlashOptional = (p?: string) =>\n    typeof p === \"undefined\" ? undefined : withForwardSlash(p);\n\nexport const noTrailingSlash = (p: string) =>\n    p.endsWith(\"/\") ? p.slice(0, p.length - 1) : p;\n\nexport const withTrailingSlash = (p: string) => (p.endsWith(\"/\") ? p : `${p}/`);\n\nexport const makeHref = (s: string) => {\n    if (/^http(s?):\\/\\//gm.test(s)) {\n        return s;\n    }\n    if(typeof window === \"undefined\"){\n        return s\n    }\n    let isHttps = window?.location?.href.startsWith(\"http\")\n        ? window.location.href.startsWith(\"https\")\n        : process.env.NEXT_PUBLIC_PRODUCTION_REMOTE;\n    return `${isHttps ? \"https\" : \"http\"}://${s}`;\n};\n\nexport const noLeadingSlash = (p: string) =>\n    p.startsWith(\"/\") ? p.slice(1, p.length) : p;\n\nexport const setSlashes = ({\n    value,\n    leading,\n    trailing,\n}: {\n    value: string;\n    leading: boolean;\n    trailing: boolean;\n}) => {\n    let v = value;\n    v = leading ? withForwardSlash(v) : noLeadingSlash(v);\n    v = trailing ? withTrailingSlash(v) : noTrailingSlash(v);\n    return v;\n};\n\nexport const parentDir = (p: string) =>\n    p.indexOf(\"/\") >= 0 ? p.slice(0, p.lastIndexOf(\"/\")) : p;\n\nexport const getFilenameFromString = (p: string) =>\n    p.indexOf(\"/\") === -1 ? p : p.slice(p.lastIndexOf(\"/\") + 1, p.length);\n\nexport const ensureRootRelative = (p: string, fsRoot: string) =>\n    withForwardSlash(p.indexOf(fsRoot) === -1 ? p : p.split(fsRoot)[1]);\n\nexport const ensureAbsolute = (p: string, fsRoot: string) => {\n    return p.includes(fsRoot)\n        ? p\n        : `${fsRoot}${setSlashes({ value: p, leading: true, trailing: false })}`;\n};\n\nexport const getParentDirAndFilename = (\n    p: string,\n    ensureRootRelativeParent: boolean = true,\n    fsRoot: string,\n) => {\n    return {\n        parent: ensureRootRelativeParent\n            ? ensureRootRelative(parentDir(p), fsRoot)\n            : parentDir(p),\n        filename: getFilenameFromString(p),\n    };\n};\n\nexport const fileExtension = (path: string) => {\n    return path.split(\".\").at(-1);\n};\n\nexport const replacePrefix = (\n    content: string,\n    regex: string,\n    replaceWith: string = \"\",\n) => {\n    return content.startsWith(regex)\n        ? `${replaceWith}${content.split(regex)[1]}`\n        : content;\n};\n\nexport const replaceAppendix = (\n    content: string,\n    regex: string,\n    replaceWith: string = \"\",\n) => {\n    return content.endsWith(regex)\n        ? `${content.slice(0, content.length - regex.length)}${replaceWith}`\n        : content;\n};\n\nexport const getFsRootGlob = async (\n    props: z.input<typeof filePathGlobPropsSchema>,\n) => {\n    try {\n        let res = await axios.post(\"/api/glob\", props);\n        if(res.data.filePaths){\n            return res.data.filePaths as string[];\n        }\n    } catch (err) {\n        console.error(err);\n    }\n};\n"]}